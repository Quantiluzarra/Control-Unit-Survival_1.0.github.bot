<!DOCTYPE html>
<html>
<head>
    <title>Pixel Terraria</title>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background: #222;
            touch-action: none;
        }
        canvas { 
            background: #135;
        }
        #controls {
            position: fixed;
            bottom: 10px;
            width: 100%;
            display: flex;
            justify-content: center;
        }
        .btn {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.5);
            border: 2px solid #fff;
            margin: 0 10px;
            touch-action: none;
        }
    </style>
</head>
<body>
    <canvas id="game"></canvas>
    <div id="controls">
        <div class="btn" id="left">←</div>
        <div class="btn" id="right">→</div>
        <div class="btn" id="jump">↑</div>
        <div class="btn" id="mine">⛏️</div>
    </div>

    <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Игровые константы
    const TILE_SIZE = 10;
    const WORLD_WIDTH = 200;
    const WORLD_HEIGHT = 100;

    // Состояние мира
    let world = Array(WORLD_WIDTH).fill().map(() => 
        Array(WORLD_HEIGHT).fill(0)
    );

    // Генерация мира
    function generateWorld() {
        for (let x = 0; x < WORLD_WIDTH; x++) {
            for (let y = WORLD_HEIGHT - 20; y < WORLD_HEIGHT; y++) {
                world[x][y] = Math.random() > 0.7 ? 1 : 0;
            }
        }
    }

    // Игрок
    const player = {
        x: WORLD_WIDTH / 2,
        y: 10,
        width: 1,
        height: 2,
        speed: 0.2,
        jumpStrength: 0.5,
        velocityY: 0,
        onGround: false
    };

    // Физика и движение
    function updatePhysics() {
        // Гравитация
        player.velocityY += 0.1;
        player.y += player.velocityY;

        // Столкновения с землей
        if (player.y + player.height > WORLD_HEIGHT) {
            player.y = WORLD_HEIGHT - player.height;
            player.velocityY = 0;
            player.onGround = true;
        }
    }

    // Управление
    const keys = {
        left: false,
        right: false,
        jump: false,
        mine: false
    };

    // Обработчики управления
    document.getElementById('left').addEventListener('touchstart', () => keys.left = true);
    document.getElementById('left').addEventListener('touchend', () => keys.left = false);
    document.getElementById('right').addEventListener('touchstart', () => keys.right = true);
    document.getElementById('right').addEventListener('touchend', () => keys.right = false);
    document.getElementById('jump').addEventListener('touchstart', () => {
        if (player.onGround) {
            player.velocityY = -player.jumpStrength;
            player.onGround = false;
        }
    });
    document.getElementById('mine').addEventListener('touchstart', () => keys.mine = true);
    document.getElementById('mine').addEventListener('touchend', () => keys.mine = false);

    // Отрисовка мира
    function drawWorld() {
        ctx.fillStyle = '#135';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        for (let x = 0; x < WORLD_WIDTH; x++) {
            for (let y = 0; y < WORLD_HEIGHT; y++) {
                if (world[x][y] === 1) {
                    ctx.fillStyle = '#654';
                    ctx.fillRect(
                        x * TILE_SIZE, 
                        y * TILE_SIZE, 
                        TILE_SIZE, 
                        TILE_SIZE
                    );
                }
            }
        }

        // Отрисовка игрока
        ctx.fillStyle = '#f00';
        ctx.fillRect(
            player.x * TILE_SIZE, 
            player.y * TILE_SIZE, 
            player.width * TILE_SIZE, 
            player.height * TILE_SIZE
        );
    }

    // Основной игровой цикл
    function gameLoop() {
        // Движение
        if (keys.left) player.x -= player.speed;
        if (keys.right) player.x += player.speed;

        // Физика
        updatePhysics();

        // Отрисовка
        drawWorld();

        requestAnimationFrame(gameLoop);
    }

    // Старт игры
    generateWorld();
    gameLoop();

    // Адаптивность
    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });
    </script>
</body>
</html>
